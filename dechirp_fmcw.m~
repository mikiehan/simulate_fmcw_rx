function [f, profile] = dechirp_fmcw(rtDist, Fs, fminR, B, vs, sampleInterval, nChirps, Sr, algo_name)
%fminR = 17e3;
%B = 5e3;
%Fs = 48000;
%vs = 340;
%sampleInterval=0.030; % 30 ms

Ts=1/Fs;
K=sampleInterval/Ts;

t=(0:K-1)*Ts;

      cos(2*pi*(1/2*t.^2*B/sampleInterval+fmin*t));
St0 = cos(2*pi*(1/2*t.^2*B/sampleInterval+fminR*t)); % original Tx signal
St = repmat(St0, 1 , nChirps);

%synchronizing

yR0 = genChirp( Fs,on/1000,0,fmin*1000,B,1);

%synchronizing to remove the intial noise
maxIndex=syncFMCWSymbol(y,0,yR0,length(yR0));



Sm = St .* Sr; % mixing St and Sr
% de-chirp
figure;
profile = [];
for c=1:nChirps
    [f,fft1] = plotFFT(Sm(1 + (c-1) * K : c*K),Fs);
    dist = vs*f*sampleInterval*1000/B;
    plot(dist, fft1); % should peak at D
    hold on;
    xlim([0 rtDist*2]);
    %ylim([0 0.01]);
    profile = [profile; fft1];
end
title(algo_name)
xlabel('Distance (m)')
ylabel('Amplitude')
end